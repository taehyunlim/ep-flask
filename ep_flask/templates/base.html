{% extends 'bootstrap/base.html' %}
{% block title %}ep_flask{% endblock %}
{% block scripts %}
  {{ super() }}
  {{ moment.include_moment() }}
<script>
  // Inject stringified address response from the API call
  function retrieveAddress(id) {
    let node = `#${id}`
    // Loader Image
    $(node).html(`<img src="{{ url_for('static', filename='loading.gif') }}">`);
    // Ajax request to retrieve endpoint
    $.post(`/address/${id}/retrieve`)
    .done(function(res) {
      console.log(res);
      $(node).html(`<pre>${res}</pre>`)
    })
    .fail(function() {
      $(node).html("Error: API Failure");
    });
  }
  // Call retrieveAddress on click
  $(".address-collapse").click(function() {
    let id = $(this).html().trim()
    retrieveAddress(id);
  });
</script>
{% endblock %}

{% block navbar %}
  <nav class="navbar navbar-default">
    <div class="container">
      <div class="navbar-header">
        <a class="navbar-brand" href="{{ url_for('index') }}">ep_flask</a>
      </div>
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li><a href="{{ url_for('index') }}">Index</a></li>
          <li><a href="{{ url_for('address') }}">Address</a></li>
        </ul>
      </div>
    </div>
  </nav>
{% endblock %}

{% block content %}
  <div class="container">
    {% with messages = get_flashed_messages() %}{% if messages %}
      {% for message in messages %}
      <div class="alert alert-info" role="alert">{{ message }}</div>
      {% endfor %}
    {% endif %}{% endwith %}

    {% block app_content %}{% endblock %}
  </div>
{% endblock %}